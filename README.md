# üìÑ Document Processing Agent

**–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π AI-–∞–≥–µ–Ω—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ –¥–æ–≥–æ–≤–æ—Ä–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ LLM –∏ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–≥–æ RAG (Retrieval-Augmented Generation).**

---

## ÔøΩ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã

[![–í–∏–¥–µ–æ-–¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è](https://img.shields.io/badge/üìπ_–°–º–æ—Ç—Ä–µ—Ç—å_–¥–µ–º–æ-Google_Drive-4285F4?style=for-the-badge&logo=googledrive&logoColor=white)](https://drive.google.com/file/d/1vsVoWvvZyAyWx_FrWVmng8Cb5PmVuK_p/view?usp=sharing)

> üé• **–°–∫—Ä–∏–Ω–∫–∞—Å—Ç**: –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç—ã –∞–≥–µ–Ω—Ç–∞ ‚Äî –æ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ø–æ—á—Ç–µ –¥–æ —Å–æ–∑–¥–∞–Ω–∏—è Excel-–æ—Ç—á—ë—Ç–∞

---

## ÔøΩüéØ –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ä—É—Ç–∏–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã —é—Ä–∏—Å—Ç–æ–≤ –∏ –æ—Ñ–∏—Å-–º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –ø–æ –æ–±—Ä–∞–±–æ—Ç–∫–µ –≤—Ö–æ–¥—è—â–∏—Ö –¥–æ–≥–æ–≤–æ—Ä–æ–≤. –ê–≥–µ–Ω—Ç:

1. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –ø–æ—á—Ç–æ–≤–æ–º—É —è—â–∏–∫—É (Gmail, Yandex, Mail.ru, Outlook)
2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç –ø–∏—Å—å–º–∞ —Å –¥–æ–≥–æ–≤–æ—Ä–∞–º–∏ –∏ –≤–ª–æ–∂–µ–Ω–∏—è–º–∏
3. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã —Å –ø–æ–º–æ—â—å—é **–ª–æ–∫–∞–ª—å–Ω–æ–π LLM** (–¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ–∫–∏–¥–∞—é—Ç –≤–∞—à—É –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É)
4. –ò–∑–≤–ª–µ–∫–∞–µ—Ç –∫–ª—é—á–µ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é: —Å—Ç–æ—Ä–æ–Ω—ã, —Å—É–º–º—ã, —Å—Ä–æ–∫–∏, –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö
5. –§–æ—Ä–º–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π **Excel-–æ—Ç—á—ë—Ç**
6. –í–µ–¥—ë—Ç **–Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** –Ω–æ–≤—ã—Ö –ø–∏—Å–µ–º

### üë• –¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è

| –°–µ–≥–º–µ–Ω—Ç | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ |
|---------|------------|
| üè¢ **–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –æ—Ç–¥–µ–ª—ã** | –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –≤—Ö–æ–¥—è—â–µ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç–∞ |
| üíº **–ú–∞–ª—ã–π –∏ —Å—Ä–µ–¥–Ω–∏–π –±–∏–∑–Ω–µ—Å** | –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–≥–æ–≤–æ—Ä–æ–≤ –±–µ–∑ –Ω–∞–π–º–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ |
| üë§ **–§—Ä–∏–ª–∞–Ω—Å–µ—Ä—ã –∏ –ò–ü** | –£—á—ë—Ç –¥–æ–≥–æ–≤–æ—Ä–Ω—ã—Ö –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤ |
| üìä **–ë—É—Ö–≥–∞–ª—Ç–µ—Ä–∏–∏** | –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —É—á—ë—Ç–∞ |

### ‚ú® –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞

| –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------------|----------|
| üîí **–ü–æ–ª–Ω–∞—è –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å** | –õ–æ–∫–∞–ª—å–Ω–∞—è LLM ‚Äî –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ–∫–∏–¥–∞—é—Ç –≤–∞—à—É –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É |
| üìß **–ú—É–ª—å—Ç–∏–ø—Ä–æ–≤–∞–π–¥–µ—Ä** | Gmail, Yandex, Mail.ru, Outlook –∏–∑ –∫–æ—Ä–æ–±–∫–∏ |
| ü§ñ **–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π RAG** | Pre/Post-retrieval —Å —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–º–∏ —Å–∏–Ω–æ–Ω–∏–º–∞–º–∏ |
| üìä **–ì–æ—Ç–æ–≤—ã–π –æ—Ç—á—ë—Ç** | Excel-—Ç–∞–±–ª–∏—Ü–∞ —Å –∫–ª—é—á–µ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π |
| üîÑ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ 24/7** | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–∏—Å–µ–º |
| üîê **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤** | AES-256 —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ |

---

## üõ† –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∏—à–∫–∏

- **–õ–æ–∫–∞–ª—å–Ω—ã–π LLM**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GGUF –º–æ–¥–µ–ª–∏ Saiga (—Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω–∞—è) —á–µ—Ä–µ–∑ llama-cpp-python
- **RAG Pipeline**: –î–≤—É—Ö—ç—Ç–∞–ø–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å Pre-Retrieval (—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤) –∏ Post-Retrieval (–ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ)
- **–£–º–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–æ–≤**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–º –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
- **–ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –°–µ–º–∞—Ñ–æ—Ä –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è GPU-–Ω–∞–≥—Ä—É–∑–∫–∏
- **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**: Fernet (AES-256) –¥–ª—è –∑–∞—â–∏—Ç—ã —à–∞–±–ª–æ–Ω–æ–≤ –¥–æ–≥–æ–≤–æ—Ä–æ–≤

### üöÄ Roadmap (–¥–∞–ª—å–Ω–µ–π—à–∏–µ —à–∞–≥–∏)

- [ ] OCR –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (Tesseract/PaddleOCR)
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CRM —Å–∏—Å—Ç–µ–º–∞–º–∏ (Bitrix24, AmoCRM)
- [ ] Telegram/Slack —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –¥–æ–≥–æ–≤–æ—Ä–∞—Ö
- [ ] –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–∏–ø–æ–≤ –¥–æ–≥–æ–≤–æ—Ä–æ–≤ (–∞—Ä–µ–Ω–¥–∞, –ø–æ—Å—Ç–∞–≤–∫–∞, —É—Å–ª—É–≥–∏)
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–Ω—ã—Ö –ø–∏—Å–µ–º
- [ ] –ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (EN, DE, KZ)
- [ ] –í–µ–∫—Ç–æ—Ä–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (ChromaDB/FAISS) –¥–ª—è —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ RAG

---

## üì¶ –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ —Ä–µ—Å—É—Ä—Å—ã

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```txt
# Core
python-dotenv==1.0.0
streamlit>=1.28.0

# LLM (–ª–æ–∫–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å)
llama-cpp-python>=0.2.27

# Document processing
docx2txt==0.8
openpyxl==3.1.2
pandas>=2.0.0
PyPDF2>=3.0.0

# Security
cryptography>=41.0.0
```

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

| –í–∞—Ä–∏–∞–Ω—Ç | RAM | GPU | –î–∏—Å–∫ |
|---------|-----|-----|------|
| CPU only | 8 GB | ‚Äî | 5 GB |
| GPU (CUDA) | 8 GB | 4 GB VRAM | 5 GB |

### –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- **Python 3.10+**
- **GGUF –º–æ–¥–µ–ª—å** –≤ –ø–∞–ø–∫–µ `models/` (Saiga ‚Äî —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω–∞—è –º–æ–¥–µ–ª—å)
- **–®–∞–±–ª–æ–Ω—ã –¥–æ–≥–æ–≤–æ—Ä–æ–≤** (.docx) –≤ –ø–∞–ø–∫–µ `templates/` –∏–ª–∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤ `templates_encrypted/`

---

## üìä –î–∞–Ω–Ω—ã–µ

### –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö

–î–ª—è –æ–±—É—á–µ–Ω–∏—è RAG-—Å–∏—Å—Ç–µ–º—ã –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å **—Ä–µ–∞–ª—å–Ω–∞—è –±–∞–∑–∞ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫—É—é—â–∏–º —é—Ä–∏—Å—Ç–æ–º –Ω–∞ —É—Å–ª–æ–≤–∏—è—Ö –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏.

### –°–æ—Å—Ç–∞–≤ –¥–∞—Ç–∞—Å–µ—Ç–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤** | ~580 –¥–æ–≥–æ–≤–æ—Ä–æ–≤ |
| **–¢–∏–ø—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤** | –î–æ–≥–æ–≤–æ—Ä—ã –ø–æ—Å—Ç–∞–≤–∫–∏, –∞—Ä–µ–Ω–¥—ã, –ø–æ–¥—Ä—è–¥–∞, —É—Å–ª—É–≥, –∫—É–ø–ª–∏-–ø—Ä–æ–¥–∞–∂–∏ |
| **–§–æ—Ä–º–∞—Ç** | .docx (Microsoft Word) |
| **–Ø–∑—ã–∫** | –†—É—Å—Å–∫–∏–π |
| **–ü–µ—Ä–∏–æ–¥** | 2017‚Äì2024 –≥–≥. |

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

1. **–°–±–æ—Ä**: –ü–æ–ª—É—á–µ–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞ –¥–æ–≥–æ–≤–æ—Ä–æ–≤ –æ—Ç —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–∞
2. **–û—á–∏—Å—Ç–∫–∞**: –£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∏ –ø–æ–≤—Ä–µ–∂–¥—ë–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
3. **–ê–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è**: –í—Å–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞—é—Ç—Å—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º–∏
4. **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ**: AES-256 (Fernet) –¥–ª—è –∑–∞—â–∏—Ç—ã –ø—Ä–∏ —Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
5. **–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è**: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è RAG pipeline

### –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ**: –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –¥–æ–≥–æ–≤–æ—Ä—ã (`templates/`) —Å–æ–¥–µ—Ä–∂–∞—Ç –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ **–ù–ï** –≤–∫–ª—é—á–µ–Ω—ã –≤ –ø—É–±–ª–∏—á–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π. –í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ (`templates_encrypted/`), –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –±–µ–∑ –∫–ª—é—á–∞.

---

## ‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Email Agent   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   RAG Pipeline   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   Document      ‚îÇ
‚îÇ   (IMAP)        ‚îÇ     ‚îÇ (Pre/Post)       ‚îÇ     ‚îÇ   Processor     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                       ‚îÇ                        ‚îÇ
         ‚ñº                       ‚ñº                        ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Gmail/Yandex  ‚îÇ     ‚îÇ   Templates DB   ‚îÇ     ‚îÇ   Local LLM     ‚îÇ
‚îÇ   Mail.ru       ‚îÇ     ‚îÇ   (DOCX files)   ‚îÇ     ‚îÇ   (GGUF)        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                                          ‚îÇ
                                                          ‚ñº
                                                 ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                                                 ‚îÇ   Excel Report  ‚îÇ
                                                 ‚îÇ   (openpyxl)    ‚îÇ
                                                 ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### RAG Pipeline

**Pre-Retrieval (–¥–æ –ø–æ–∏—Å–∫–∞):**
- –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–º–∏ —Å–∏–Ω–æ–Ω–∏–º–∞–º–∏
- `–¥–æ–≥–æ–≤–æ—Ä` ‚Üí `–∫–æ–Ω—Ç—Ä–∞–∫—Ç, —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ, —Å–¥–µ–ª–∫–∞`
- `–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å` ‚Üí `–ø–æ–¥—Ä—è–¥—á–∏–∫, –ø–æ—Å—Ç–∞–≤—â–∏–∫, –ø—Ä–æ–¥–∞–≤–µ—Ü`
- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞

**Post-Retrieval (–ø–æ—Å–ª–µ –ø–æ–∏—Å–∫–∞):**
- –ü–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –∫–ª—é—á–µ–≤—ã–º —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–º —Ç–µ—Ä–º–∏–Ω–∞–º
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø–æ—Ä–æ–≥—É —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏
- –û—Ü–µ–Ω–∫–∞ "–¥–æ–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç–∏" –¥–æ–∫—É–º–µ–Ω—Ç–∞

### –¢–µ—Ö–Ω–∏–∫–∏ –ø—Ä–æ–º–ø—Ç–∏–Ω–≥–∞

```python
prompt = """–¢—ã - —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –¥–æ–≥–æ–≤–æ—Ä –∏ –∏–∑–≤–ª–µ–∫–∏:
1. –¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–∞ (–¥–æ–≥–æ–≤–æ—Ä –ø–æ—Å—Ç–∞–≤–∫–∏, –∞—Ä–µ–Ω–¥—ã, —É—Å–ª—É–≥ –∏ —Ç.–¥.)
2. –°—Ç–æ—Ä–æ–Ω—ã –¥–æ–≥–æ–≤–æ—Ä–∞ (–ó–∞–∫–∞–∑—á–∏–∫, –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å)
3. –ü—Ä–µ–¥–º–µ—Ç –¥–æ–≥–æ–≤–æ—Ä–∞
4. –°—É–º–º–∞ –∏ –ø–æ—Ä—è–¥–æ–∫ –æ–ø–ª–∞—Ç—ã
5. –°—Ä–æ–∫–∏ –¥–µ–π—Å—Ç–≤–∏—è
6. –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –ª–∏—Ü–∞

–û—Ç–≤–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON."""
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–≤–æ–¥ (JSON) –¥–ª—è –Ω–∞–¥—ë–∂–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞
- –†–æ–ª—å "—é—Ä–∏–¥–∏—á–µ—Å–∫–æ–≥–æ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞" –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –Ø–≤–Ω–æ–µ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ –ø–æ–ª–µ–π –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è
- –ù–∏–∑–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (0.1) –¥–ª—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏

### –ú–æ–¥–µ–ª—å

| –ú–æ–¥–µ–ª—å | –†–∞–∑–º–µ—Ä | VRAM | –ö–∞—á–µ—Å—Ç–≤–æ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|--------|------|----------|----------|
| **Saiga** (model-q4_K.gguf) | ~4 GB | 4 GB | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | –†—É—Å—Å–∫–æ—è–∑—ã—á–Ω–∞—è –º–æ–¥–µ–ª—å, –æ–±—É—á–µ–Ω–Ω–∞—è –Ω–∞ —Ä—É—Å—Å–∫–∏—Ö —Ç–µ–∫—Å—Ç–∞—Ö |

### –•—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö

- **Email**: IMAP –ø—Ä–æ—Ç–æ–∫–æ–ª (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π imaplib)
- **–î–æ–∫—É–º–µ–Ω—Ç—ã**: –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ (DOCX, PDF)
- **–®–∞–±–ª–æ–Ω—ã**: –ü–∞–ø–∫–∞ `templates/` —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –¥–æ–≥–æ–≤–æ—Ä–æ–≤
- **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã**: Excel —Ñ–∞–π–ª—ã (openpyxl)
- **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ**: Fernet (AES-256) –¥–ª—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤

---

## üåê –î–µ–ø–ª–æ–π

### –ì–¥–µ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç–æ

**–õ–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä / Docker** ‚Äî –≤—ã–±—Ä–∞–Ω –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –ø–æ–ª–Ω–æ–π –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö.

> ‚ö†Ô∏è Streamlit Cloud –∏ –¥—Ä—É–≥–∏–µ –æ–±–ª–∞—á–Ω—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã **–Ω–µ –ø–æ–¥—Ö–æ–¥—è—Ç** –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞, —Ç–∞–∫ –∫–∞–∫:
> 1. –¢—Ä–µ–±—É–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–∞—è LLM –º–æ–¥–µ–ª—å (~4 GB)
> 2. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
> 3. –ù—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø –∫ IMAP —Å–µ—Ä–≤–µ—Ä–∞–º

### –ü–æ—á–µ–º—É Docker

- ‚úÖ –ò–∑–æ–ª—è—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å –Ω–∞ –ª—é–±–æ–π –º–∞—à–∏–Ω–µ
- ‚úÖ –ü—Ä–æ—Å—Ç–æ—Ç–∞ –¥–µ–ø–ª–æ—è –Ω–∞ VPS/—Å–µ—Ä–≤–µ—Ä
- ‚úÖ Volumes –¥–ª—è –º–æ–¥–µ–ª–µ–π –∏ –¥–∞–Ω–Ω—ã—Ö

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone https://github.com/your-username/document_processing_agent.git
cd document_processing_agent

# 2. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python -m venv venv
venv\Scripts\activate  # Windows
source venv/bin/activate  # Linux/Mac

# 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# 4. –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ TEMPLATES_KEY –∫–∞–∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è
python scripts/encrypt_templates.py --decrypt

# 5. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
streamlit run .streamlit/app_streamlit.py
```

### Docker –∑–∞–ø—É—Å–∫

```bash
# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
docker-compose build

# –ó–∞–ø—É—Å–∫
docker-compose up -d

# –û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ
# http://localhost:8501
```

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º

1. **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** (Streamlit) ‚Äî –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–π UI –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
2. **–ü–æ—à–∞–≥–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å**: –í–≤–æ–¥ email ‚Üí –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ ‚Üí –ü–æ–∏—Å–∫ –¥–æ–≥–æ–≤–æ—Ä–æ–≤ ‚Üí –ê–Ω–∞–ª–∏–∑ ‚Üí –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –æ—Ç—á—ë—Ç–∞
3. **Real-time –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –ö–Ω–æ–ø–∫–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –ø–∏—Å–µ–º

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
document_processing_agent/
‚îú‚îÄ‚îÄ .streamlit/
‚îÇ   ‚îî‚îÄ‚îÄ app_streamlit.py      # –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (Streamlit)
‚îú‚îÄ‚îÄ config.py                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ requirements.txt          # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ Dockerfile               # Docker –æ–±—Ä–∞–∑
‚îú‚îÄ‚îÄ docker-compose.yml       # Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ agents/
‚îÇ   ‚îî‚îÄ‚îÄ email_agent.py       # –ê–≥–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ—á—Ç–æ–π (IMAP)
‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îú‚îÄ‚îÄ llm.py              # –ö–ª–∏–µ–Ω—Ç –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π LLM
‚îÇ   ‚îî‚îÄ‚îÄ rag.py              # RAG Pipeline (Pre/Post Retrieval)
‚îú‚îÄ‚îÄ processors/
‚îÇ   ‚îî‚îÄ‚îÄ document.py         # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –∞–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îî‚îÄ‚îÄ encrypt_templates.py # –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ/—Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îî‚îÄ‚îÄ *.gguf              # LLM –º–æ–¥–µ–ª—å (–Ω–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏)
‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îî‚îÄ‚îÄ *.docx              # –®–∞–±–ª–æ–Ω—ã –¥–æ–≥–æ–≤–æ—Ä–æ–≤ (–Ω–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏)
‚îî‚îÄ‚îÄ templates_encrypted/
    ‚îî‚îÄ‚îÄ *.enc               # –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã
```

---

## üìß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—á—Ç—ã

### Gmail
1. –í–∫–ª—é—á–∏—Ç–µ 2FA –≤ –∞–∫–∫–∞—É–Ω—Ç–µ Google
2. –°–æ–∑–¥–∞–π—Ç–µ App Password: https://myaccount.google.com/apppasswords
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ 16-–∑–Ω–∞—á–Ω—ã–π –ø–∞—Ä–æ–ª—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

### Yandex
1. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚Üí –ü–∞—Ä–æ–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
2. –°–æ–∑–¥–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –ø–æ—á—Ç–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞

### Mail.ru
1. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
2. –í–∫–ª—é—á–∏—Ç–µ IMAP –∏ —Å–æ–∑–¥–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤

```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ (–æ–¥–∏–Ω —Ä–∞–∑)
python scripts/encrypt_templates.py --generate-key

# –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
python scripts/encrypt_templates.py --encrypt

# –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ (–ø—Ä–∏ –¥–µ–ø–ª–æ–µ)
export TEMPLATES_KEY="–≤–∞—à_–∫–ª—é—á"
python scripts/encrypt_templates.py --decrypt
```

### –ß—Ç–æ –∑–∞—â–∏—â–µ–Ω–æ

- ‚úÖ –®–∞–±–ª–æ–Ω—ã –¥–æ–≥–æ–≤–æ—Ä–æ–≤ (AES-256)
- ‚úÖ –ü–∞—Ä–æ–ª–∏ –ø–æ—á—Ç—ã (–≤–≤–æ–¥—è—Ç—Å—è –≤ runtime, –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è)
- ‚úÖ –ö–ª—é—á–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (–≤ .gitignore)
- ‚úÖ –ú–æ–¥–µ–ª–∏ LLM (–≤ .gitignore)

---

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License
